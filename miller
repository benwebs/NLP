###Approach to Linear Regression (Let's Hope!!!)
  # Look at Original Budget Amount for a specific Cost / Original Budget Amount for all Costs
		
		#Create new vector "Costs.OBA"
		Costs.OBA<-Direct.Labor.OBA+Direct.Material.OBA+Burden.OBA+Equipment.OBA+Subcontracts.OBA+Misc.OBA

		#Create new vectors for each cost as a percentage of total costs
		Costs.OBA<-Direct.Labor.OBA+Direct.Material.OBA+Burden.OBA+Equipment.OBA+Subcontracts.OBA+Misc.OBA
		Labor.Percentage<-Direct.Labor.OBA/Costs.OBA
		Material.Percentage<-Direct.Material.OBA/Costs.OBA
		Burden.Percentage<-Burden.OBA/Costs.OBA
		Equipment.Percentage<-Equipment.OBA/Costs.OBA
		Subcontracts.Percentage<-Subcontracts.OBA/Costs.OBA
		Misc.Percentage<-Misc.OBA/Costs.OBA
	
	# Isolate or Identify the desired response variables, as well as the independent predictor variables

		#Create new response vectors "Actual.Profit.Percentage", *******CREATE MORE**********
		Actual.Profit.Percentage<-Profit/Revenue

	# Subtract each value from the mean for that type, creating the predictor variables

		#Obtain the mean for a specific proportion of Costs
		Mean.Labor.Percentage<-mean(Labor.Percentage, na.rm=TRUE)
		Mean.Material.Percentage<-mean(Material.Percentage, na.rm=TRUE)
		Mean.Burden.Percentage<-mean(Burden.Percentage, na.rm=TRUE)
		Mean.Equipment.Percentage<-mean(Equipment.Percentage, na.rm=TRUE)
		Mean.Subcontracts.Percentage<-mean(Subcontracts.Percentage, na.rm=TRUE)
		Mean.Misc.Percentage<-mean(Misc.Percentage, na.rm=TRUE)

		#Subtract the values of the proportion from the mean of the proportion
		Labor.Predictor<-Labor.Percentage - Mean.Labor.Percentage
		Material.Predictor<-Material.Percentage - Mean.Labor.Percentage
		Burden.Predictor<-Burden.Percentage - Mean.Burden.Percentage
		Equipment.Predictor<-Equipment.Percentage - Mean.Equipment.Percentage
		Subcontracts.Predictor<-Subcontracts.Percentage - Mean.Subcontracts.Percentage
		Misc.Predictor<-Misc.Percentage - Mean.Subcontracts.Percentage

	# Concatenate n Vectors, to make a new array containing only relevent columns
		Profit.Percentage.Matrix<-cbind(Actual.Profit.Percentage,Burden.Predictor,Equipment.Predictor,
		Labor.Predictor,Material.Predictor,Subcontracts.Predictor,Misc.Predictor)

	# Remove entries that contain unwanted NA records 
		Reduced.Profit.Percentage.Matrix<- Profit.Percentage.Matrix[is.finite(rowSums(Profit.Percentage.Matrix)), ]

	# Convert the matrix into a dataframe, which can be analyzed using lm or glm. Matrix form can not.
		RPP.Dataframe<- as.data.frame(Reduced.Profit.Percentage.Matrix)

	# Check for outliers in the nonnormal data
		
		#Reduce a real vector by deleting infinite terms
		APP<-Actual.Profit.Percentage[is.finite(Actual.Profit.Percentage)]

		#Median Absolute Deviance is a robust test for outliers, we want 3 "mad's"
		Mean.Absolute.Deviance<-mad(APP, center=median(APP))
		CI<- 3*Mean.Absolute.Deviance

		#Reduce the entries labeled outliers by the MAD test from the dataframe 
		RRPP.Dataframe<-RPP.Dataframe[(APP>median(APP)-CI) & (APP<median(APP)+CI)]

		#Test the new reduced set for normality
		






	# Create a potential model, as applied to the dataframe

		#Generalized Linear Model---Key assumptions that underlie the application of standard generalized linear 
		#models (GLMs) include the statistical independence of the observations, the correct specification of the 
		#link and variance functions, the correct scale for measurement of the explanatory variables and the lack 
		#of undue influence of individual observations on the fitted model. 




		Profit.Percentage.GLM<-glm(Actual.Profit.Percentage~., family=gaussian, data=RPP.Dataframe)

		#Linear Model
		Profit.Percentage.LM<-lm(Actual.Profit.Percentage~., data=RPP.Dataframe, singular.ok=TRUE)



	# Save the result as a csv



#Key assumptions that underlie the application of standard generalized linear models (GLMs) include the statistical 
#independence of the observations, the correct specification of the link and variance functions, the correct scale 
#for measurement of the explanatory variables and the lack of undue influence of individual observations on the 
#fitted model. 



####Fancier things I haven't Organized




Profit.Percentage.GLM<-glm(Actual.Profit.Percentage~., family=gaussian, data=RPP.Dataframe)

summary(Profit.Percentage.GLM)

anova(Profit.Percentage.GLM)

Profit.Percentage.LM<-lm(Actual.Profit.Percentage~., data=RPP.Dataframe, singular.ok=TRUE)

summary(Profit.Percentage.LM)

scale(x, center=TRUE, scale=TRUE) #column center or standardize a matrix. 













